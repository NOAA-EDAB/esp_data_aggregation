plot_climate_vulnerability <- function(data){
  
  data <- data %>%
    tidyr::pivot_longer(cols = c("Low", "Moderate", "High", "Very.High"))
  
  data$name <- factor(data$name, 
                      levels = c("Low", "Moderate", "High", "Very.High"))
  
  for(i in unique(data$Attribute.Category)){
    
    plot_data <- data %>%
      dplyr::filter(Attribute.Category == i)
    
    fig <- ggplot(plot_data,
                  aes(x = name,
                      y = value,
                      fill = name))+
      geom_bar(stat = "identity",
               color = "black")+
      facet_wrap(facets = vars(Attribute),
                 ncol = 2)+
      nmfspalette::scale_fill_nmfs(palette = "regional web")+
      theme_bw()+
      labs(title = i)+
      xlab("Expert rating")+
      ylab("Number of experts")+
      theme(legend.position = "none")
    
    print(fig)
  }

}