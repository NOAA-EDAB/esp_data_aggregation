on:
  workflow_dispatch:

name: Test deploying on ESP_docs
jobs: 
  build1:
    runs-on: ubuntu-latest
    env:
      GITHUB_PAT: ${{ secrets.GH_PAT }}
      R_REMOTES_NO_ERRORS_FROM_WARNINGS: true
    
    steps:          
      - name: Checkout esp_data_aggregation
        uses: actions/checkout@v2
        with:
          path: abby
          persist-credentials: false
          
      - name: Set up R
        uses: r-lib/actions/setup-r@master
        with: 
          r-version: '4.0.3' # problem with using 4.0.4   
            
      - name: Make a folder with a file
        run: |
          Rscript -e 'list.files()
          setwd("abby")
          list.files(all.files = TRUE)
          dir.create("test-folder")
          file.create("test-folder/test-file.txt")
          list.files(all.files = TRUE)'
        
#      - name: Checkout ESP_docs
#        uses: actions/checkout@v2
#        with:
#          repository: NOAA-EDAB/ESP_docs
#          path: main
        
#      - name: What's going on
#        run: |
#          Rscript -e 'list.files()
#          list.files("main", all.files = TRUE)
#          setwd("abby")'
        
      - name: Deploy to Github
        uses: JamesIves/github-pages-deploy-action@3.7.1
        with:
          REPOSITORY_NAME: NOAA-EDAB/ESP_docs
          GITHUB_TOKEN: ${{ secrets.GH_PAT }}
          BRANCH: main # The branch the action should deploy to.
          FOLDER: test-folder # The folder the action should deploy.
          TARGET_FOLDER: Reports
          CLEAN: false # Automatically remove deleted files from the deploy branch
          
#      - name: Deploy to Github
#        uses: JamesIves/github-pages-deploy-action@4.1.1
#        with:
#          workspace: ~/abby
#          repository-name: NOAA-EDAB/ESP_docs
#          token: ${{ secrets.GH_PAT }}
#          branch: main # The branch the action should deploy to.
#          folder: test-folder # The folder the action should deploy.
#          target-folder: Reports
#          clean: false # Automatically remove deleted files from the deploy branch
