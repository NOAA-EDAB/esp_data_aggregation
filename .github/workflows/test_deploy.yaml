on:
  workflow_dispatch:

name: Test deploying on ESP_docs
jobs: 
  build1:
    runs-on: ubuntu-latest
    env:
      GITHUB_PAT: ${{ secrets.GH_PAT }}
      R_REMOTES_NO_ERRORS_FROM_WARNINGS: true
    
    steps:          
      - name: Checkout esp_data_aggregation
        uses: actions/checkout@v2
        with:
          path: abby
          
      - name: Set up R
        uses: r-lib/actions/setup-r@master
        with: 
          r-version: '4.0.3' # problem with using 4.0.4   
            
      - name: Make a folder with a file
        run: |
          Rscript -e 'list.files()
          setwd("abby")
          list.files(all.files = TRUE)
          dir.create("test-folder")
          file.create("test-folder/test-file.txt")
          list.files(all.files = TRUE)'
#        shell: bash
#        working-directory: ~/esp_data_aggregation

#      - name: What's here
#        run: ls
#        shell: bash
        
#      - name: Make a folder
#        run: mkdir ~/test-folder
#        shell: bash

#      - name: Make a file
#        run: echo "Some line" > ~/test-folder/test.txt
#        shell: bash
        
#      - name: What's here (again)
#        run: ls
#        shell: bash
        
#      - name: What's here (in abby branch?)
#        run: |
#          cd abby
#          ls
#        shell: bash
        
#      - name: Checkout ESP_docs
#        uses: actions/checkout@v2
#        with:
#          repository: NOAA-EDAB/ESP_docs
#          path: main
        
      - name: Deploy to Github
        uses: JamesIves/github-pages-deploy-action@4.1.1
        with:
          repository-name: ESP_docs
          token: ${{ secrets.GH_PAT }}
          branch: main # The branch the action should deploy to.
          folder: abby/test-folder # The folder the action should deploy.
          target-folder: Reports
          clean: false # Automatically remove deleted files from the deploy branch
