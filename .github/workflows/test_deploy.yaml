on:
  workflow_dispatch:

name: Test deploying on ESP_docs
jobs: 
  build1:
    runs-on: ubuntu-latest
    env:
      GITHUB_PAT: ${{ secrets.GH_PAT }}
      R_REMOTES_NO_ERRORS_FROM_WARNINGS: true
    
    steps:          
      - name: Checkout esp_data_aggregation
        uses: actions/checkout@v2
        with:
          path: abby

      - name: Checkout ESP_docs
        uses: actions/checkout@v2
        with:
          repository: NOAA-EDAB/ESP_docs
          path: main
              
#      - name: Make a folder with a file
#        run: |
#          ls
#          mkdir ~/esp_data_aggregation/test-folder
#          echo "Some line" > ~/esp_data_aggregation/test-folder/test.txt
#          ls
#        shell: bash
#        working-directory: ~/esp_data_aggregation

      - name: What's here
        run: ls
        shell: bash
        
      - name: Make a folder
        run: mkdir ~/abby/test-folder
        shell: bash

      - name: Make a file
        run: echo "Some line" > ~/abby/test-folder/test.txt
        shell: bash
        
      - name: What's here (again)
        run: ls
        shell: bash
        
      - name: What's here (in abby branch?)
        run: |
          cd abby
          ls
        shell: bash
        
      - name: Deploy to Github
        uses: JamesIves/github-pages-deploy-action@4.1.1
        with:
          repository-name: ESP_docs
          token: ${{ secrets.GH_PAT }}
          branch: main # The branch the action should deploy to.
          folder: test-folder # The folder the action should deploy.
          target-folder: Reports
          clean: false # Automatically remove deleted files from the deploy branch
